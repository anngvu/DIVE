library(MetaboAnalystR)

# Get PubChem IDs from significance analysis
chems <- readLines("sigAPUBCHEM.txt")

mSet <- InitDataObjects("conc", "msetora", FALSE)
#Set up mSetObj with the list of compounds
mSet <- Setup.MapData(mSet, chems)
mSet <- CrossReferencing(mSet, "pubchem")
mSet <- CreateMappingResultTable(mSet)
mSet <- SetMetabolomeFilter(mSet, F)

# Using SNP enrichment
mSet <- SetCurrentMsetLib(mSet, "snp", 2)
mSet <- CalculateHyperScore(mSet)
mSet <- PlotORA(mSet, "ora_0_", "net", "png", 72, width=NA)
mSet <- CalculateHyperScore(mSet)
mSet <- PlotORA(mSet, "ora_1_", "net", "png", 72, width=NA)


